{"ast":null,"code":"import React,{useContext,useEffect,useState}from'react';import{Context}from\"../../index\";import{Button,Col,Dropdown,Form,Modal,Row}from\"react-bootstrap\";import{createDevice,fetchBrands,fetchTypes}from\"../../http/deviceAPI\";import{observer}from\"mobx-react-lite\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const CreateDevice=observer(_ref=>{let{show,onHide}=_ref;const{device}=useContext(Context);const[name,setName]=useState('');const[price,setPrice]=useState(0);const[file,setFile]=useState(null);const[info,setInfo]=useState([]);useEffect(()=>{fetchTypes().then(data=>device.setTypes(data));fetchBrands().then(data=>device.setBrands(data));},[]);const addInfo=()=>{setInfo([...info,{title:'',description:'',number:Date.now()}]);};const deleteInfo=number=>{setInfo(info.filter(item=>item.number!==number));};const changeInfo=(key,value,number)=>{setInfo(info.map(i=>i.number===number?{...i,[key]:value}:i));};const selectFile=e=>{setFile(e.target.files[0]);};const addDevice=()=>{const formData=new FormData();formData.append('name',name);formData.append('price',\"\".concat(price));formData.append('img',file);formData.append('brandId',device.selectedBrand.id);formData.append('typeId',device.selectedType.id);formData.append('info',JSON.stringify(info));createDevice(formData).then(()=>onHide());};return/*#__PURE__*/_jsxs(Modal,{show:show,onHide:onHide,size:\"lg\",centered:true,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Add new Device\"})}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(Dropdown,{className:\"mt-2 mb-2\",children:[/*#__PURE__*/_jsx(Dropdown.Toggle,{children:device.selectedType.name||\"Choose your Type\"}),/*#__PURE__*/_jsx(Dropdown.Menu,{children:device.types.map(type=>/*#__PURE__*/_jsx(Dropdown.Item,{onClick:()=>device.setSelectedType(type),children:type.name},type.id))})]}),/*#__PURE__*/_jsxs(Dropdown,{className:\"mt-2 mb-2\",children:[/*#__PURE__*/_jsx(Dropdown.Toggle,{children:device.selectedBrand.name||\"Choose your Brand\"}),/*#__PURE__*/_jsx(Dropdown.Menu,{children:device.brands.map(brand=>/*#__PURE__*/_jsx(Dropdown.Item,{onClick:()=>device.setSelectedBrand(brand),children:brand.name},brand.id))})]}),/*#__PURE__*/_jsx(Form.Control,{value:name,onChange:e=>setName(e.target.value),className:\"mt-3\",placeholder:\"Input name your device...\"}),/*#__PURE__*/_jsx(Form.Control,{value:price,onChange:e=>setPrice(Number(e.target.value)),className:\"mt-3\",placeholder:\"Input name price for the device...\",type:\"number\"}),/*#__PURE__*/_jsx(Form.Control,{className:\"mt-3\",type:\"file\",onChange:selectFile}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(Button,{variant:\"outline-dark\",onClick:()=>addInfo(),children:\"Add new property\"}),info.map(item=>/*#__PURE__*/_jsxs(Row,{className:\"mt-3\",children:[/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Form.Control,{placeholder:\"Input title for the device...\",value:item.title,onChange:e=>changeInfo('title',e.target.value,item.number)})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Form.Control,{placeholder:\"Input description for the device...\",value:item.description,onChange:e=>changeInfo('description',e.target.value,item.number)})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Button,{variant:\"outline-danger\",onClick:()=>deleteInfo(item.number),children:\"Delete new property\"})})]},item.number))]})}),/*#__PURE__*/_jsxs(Modal.Footer,{children:[/*#__PURE__*/_jsx(Button,{variant:\"outline-danger\",onClick:onHide,children:\"Close\"}),/*#__PURE__*/_jsx(Button,{variant:\"outline-success\",onClick:addDevice,children:\"Add\"})]})]});});export default CreateDevice;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}