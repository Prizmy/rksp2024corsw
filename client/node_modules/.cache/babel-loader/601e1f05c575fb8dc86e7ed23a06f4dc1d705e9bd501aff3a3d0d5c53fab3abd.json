{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\18062\\\\OneDrive\\\\\\u0420\\u0430\\u0431\\u043E\\u0447\\u0438\\u0439 \\u0441\\u0442\\u043E\\u043B\\\\\\u0412\\u0423\\u0423\\u0423\\u0423\\u0423\\u0423\\u0423\\u0423\\u0423\\u0423\\u0423\\u0417\\\\3 \\u041A\\u0423\\u0420\\u0421 2 6 \\u0421\\u0415\\u041C\\u0410\\u041A\\\\12312312313213123\\\\onlineStore-master\\\\onlineStore-master\\\\client\\\\src\\\\pages\\\\DevicePageEdit.js\",\n  _s = $RefreshSig$();\nimport React, { useContext, useEffect, useState } from 'react';\nimport { Button, Col, Container, Dropdown, Form, Image, Modal, Row } from \"react-bootstrap\";\nimport { useParams } from 'react-router-dom';\nimport { fetchDeleteDevice, fetchOneDevice, updateDevices } from \"../http/deviceAPI\";\nimport { Context } from \"../index\";\nimport { ADMIN_ROUTE } from \"../utils/consts\";\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DevicePageEdit = () => {\n  _s();\n  const {\n    device\n  } = useContext(Context);\n  const {\n    id\n  } = useParams();\n  const [deviceCurr, setDeviceCurr] = useState({});\n  const [showMsg, setShowMsg] = useState(false);\n  const [msg, setMsg] = useState(\"\");\n  const [selectBrand, setSelectBrand] = useState({});\n  const [selectType, setSelectType] = useState({});\n  const [name, setName] = useState(\"\");\n  const [price, setPrice] = useState(0);\n  const [img, setImg] = useState(\"\");\n  const [imgFile, setImgFile] = useState(null);\n  const [info, setInfo] = useState([]);\n  const [isDisabledPutBtn, setDisabledPutBtn] = useState(true);\n  const navigate = useNavigate();\n  const deleteDevice = () => {\n    fetchDeleteDevice(id).then(() => {\n      navigate(ADMIN_ROUTE);\n    });\n  };\n  const handleClose = () => setShow(false);\n  const handleShow = () => setShow(true);\n\n  // Остальной код будет в следующем сообщении...\n  const imgHandler = e => {\n    e.preventDefault();\n    const reader = new FileReader();\n    reader.onload = () => {\n      setImg(reader.result);\n    };\n    reader.readAsDataURL(e.target.files[0]);\n    setImgFile(e.target.files[0]);\n  };\n\n  // Добавление и удаление информации о характеристиках\n  const addInfo = () => {\n    setInfo([...info, {\n      title: '',\n      description: '',\n      id: Date.now()\n    }]);\n  };\n  const deleteInfo = id => {\n    setInfo(info.filter(item => item.id !== id));\n  };\n  const changeInfo = (key, value, id) => {\n    setInfo(info.map(item => item.id === id ? {\n      ...item,\n      [key]: value\n    } : item));\n  };\n\n  // Обновление информации о устройстве\n  const putDevice = () => {\n    const formData = new FormData();\n    formData.append('name', name);\n    formData.append('price', price);\n    formData.append('img', imgFile);\n    formData.append('brandId', selectBrand.id);\n    formData.append('typeId', selectType.id);\n    formData.append('info', JSON.stringify(info));\n    updateDevices(id, formData).then(data => {\n      setShowMsg(true);\n      setMsg(data);\n      setTimeout(() => setShowMsg(false), 5000);\n    });\n  };\n\n  // Проверка на заполненность информации о характеристиках\n  const checkInfo = () => {\n    let isEmpty = false;\n    info.forEach(item => {\n      if (!item.title || !item.description) {\n        isEmpty = true;\n      }\n    });\n    return isEmpty;\n  };\n  useEffect(() => {\n    let isEmptyInfo = false;\n    if (deviceCurr.info && deviceCurr.info.length !== info.length) {\n      isEmptyInfo = checkInfo();\n    }\n    if (deviceCurr.brand && deviceCurr.type && (deviceCurr.brand.name !== selectBrand.name || deviceCurr.type.name !== selectType.name || deviceCurr.name !== name || deviceCurr.price !== price || img || isEmptyInfo)) {\n      setDisabledPutBtn(false);\n    } else {\n      setDisabledPutBtn(true);\n    }\n  }, [name, selectBrand, selectType, price, img, info, deviceCurr]);\n  useEffect(() => {\n    fetchOneDevice(id).then(data => {\n      setDeviceCurr(data);\n      setSelectBrand(data.brand);\n      setSelectType(data.type);\n      setName(data.name);\n      setPrice(data.price);\n      setInfo(data.info);\n    });\n  }, [id]);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    className: \"mt-3\",\n    children: showMsg && /*#__PURE__*/_jsxDEV(Row, {\n      children: msg\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 25\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 122,\n    columnNumber: 9\n  }, this);\n};\n_s(DevicePageEdit, \"7B83ItIGzLokD8CC6M6605Sd+Zg=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = DevicePageEdit;\nexport default DevicePageEdit;\nvar _c;\n$RefreshReg$(_c, \"DevicePageEdit\");","map":{"version":3,"names":["React","useContext","useEffect","useState","Button","Col","Container","Dropdown","Form","Image","Modal","Row","useParams","fetchDeleteDevice","fetchOneDevice","updateDevices","Context","ADMIN_ROUTE","useNavigate","jsxDEV","_jsxDEV","DevicePageEdit","_s","device","id","deviceCurr","setDeviceCurr","showMsg","setShowMsg","msg","setMsg","selectBrand","setSelectBrand","selectType","setSelectType","name","setName","price","setPrice","img","setImg","imgFile","setImgFile","info","setInfo","isDisabledPutBtn","setDisabledPutBtn","navigate","deleteDevice","then","handleClose","setShow","handleShow","imgHandler","e","preventDefault","reader","FileReader","onload","result","readAsDataURL","target","files","addInfo","title","description","Date","now","deleteInfo","filter","item","changeInfo","key","value","map","putDevice","formData","FormData","append","JSON","stringify","data","setTimeout","checkInfo","isEmpty","forEach","isEmptyInfo","length","brand","type","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/18062/OneDrive/Рабочий стол/ВУУУУУУУУУУУЗ/3 КУРС 2 6 СЕМАК/12312312313213123/onlineStore-master/onlineStore-master/client/src/pages/DevicePageEdit.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport { Button, Col, Container, Dropdown, Form, Image, Modal, Row } from \"react-bootstrap\";\nimport { useParams } from 'react-router-dom';\nimport { fetchDeleteDevice, fetchOneDevice, updateDevices } from \"../http/deviceAPI\";\nimport { Context } from \"../index\";\nimport { ADMIN_ROUTE } from \"../utils/consts\";\nimport { useNavigate } from 'react-router-dom';\n\nconst DevicePageEdit = () => {\n    const { device } = useContext(Context);\n    const { id } = useParams();\n    const [deviceCurr, setDeviceCurr] = useState({});\n    const [showMsg, setShowMsg] = useState(false);\n    const [msg, setMsg] = useState(\"\");\n\n    const [selectBrand, setSelectBrand] = useState({});\n    const [selectType, setSelectType] = useState({});\n    const [name, setName] = useState(\"\");\n    const [price, setPrice] = useState(0);\n    const [img, setImg] = useState(\"\");\n    const [imgFile, setImgFile] = useState(null);\n    const [info, setInfo] = useState([]);\n    const [isDisabledPutBtn, setDisabledPutBtn] = useState(true);\n\n    const navigate = useNavigate();\n\n    const deleteDevice = () => {\n        fetchDeleteDevice(id).then(() => {\n            navigate(ADMIN_ROUTE);\n        });\n    };\n\n    const handleClose = () => setShow(false);\n    const handleShow = () => setShow(true);\n\n// Остальной код будет в следующем сообщении...\n    const imgHandler = e => {\n        e.preventDefault();\n\n        const reader = new FileReader();\n        reader.onload = () => {\n            setImg(reader.result);\n        };\n        reader.readAsDataURL(e.target.files[0]);\n        setImgFile(e.target.files[0]);\n    };\n\n    // Добавление и удаление информации о характеристиках\n    const addInfo = () => {\n        setInfo([...info, { title: '', description: '', id: Date.now() }]);\n    };\n\n    const deleteInfo = (id) => {\n        setInfo(info.filter(item => item.id !== id));\n    };\n\n    const changeInfo = (key, value, id) => {\n        setInfo(info.map(item => item.id === id ? { ...item, [key]: value } : item));\n    };\n\n    // Обновление информации о устройстве\n    const putDevice = () => {\n        const formData = new FormData();\n        formData.append('name', name);\n        formData.append('price', price);\n        formData.append('img', imgFile);\n        formData.append('brandId', selectBrand.id);\n        formData.append('typeId', selectType.id);\n        formData.append('info', JSON.stringify(info));\n\n        updateDevices(id, formData).then(data => {\n            setShowMsg(true);\n            setMsg(data);\n            setTimeout(() => setShowMsg(false), 5000);\n        });\n    };\n\n    // Проверка на заполненность информации о характеристиках\n    const checkInfo = () => {\n        let isEmpty = false;\n        info.forEach(item => {\n            if (!item.title || !item.description) {\n                isEmpty = true;\n            }\n        });\n        return isEmpty;\n    };\n\n    useEffect(() => {\n        let isEmptyInfo = false;\n        if (deviceCurr.info && deviceCurr.info.length !== info.length) {\n            isEmptyInfo = checkInfo();\n        }\n\n        if (\n            deviceCurr.brand && deviceCurr.type &&\n            (deviceCurr.brand.name !== selectBrand.name ||\n                deviceCurr.type.name !== selectType.name ||\n                deviceCurr.name !== name ||\n                deviceCurr.price !== price ||\n                img ||\n                isEmptyInfo)\n        ) {\n            setDisabledPutBtn(false);\n        } else {\n            setDisabledPutBtn(true);\n        }\n    }, [name, selectBrand, selectType, price, img, info, deviceCurr]);\n\n    useEffect(() => {\n        fetchOneDevice(id).then(data => {\n            setDeviceCurr(data);\n            setSelectBrand(data.brand);\n            setSelectType(data.type);\n            setName(data.name);\n            setPrice(data.price);\n            setInfo(data.info);\n        });\n    }, [id]);\n\n    return (\n        <Container className=\"mt-3\">\n            {showMsg && <Row>{msg}</Row>}\n\n            {/* Остальной код UI здесь... */}\n        </Container>\n    );\n};\n\nexport default DevicePageEdit;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}